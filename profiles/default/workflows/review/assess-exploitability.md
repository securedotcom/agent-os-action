# Assess Exploitability Workflow

## Objective
Systematically classify each vulnerability by how easily it can be exploited in practice.

## Exploitability Classification System

### ‚ö†Ô∏è Trivial (IMMEDIATE FIX REQUIRED)
**Criteria**:
- Can be exploited in <10 minutes
- No authentication required OR basic auth trivially bypassed
- No special tools or knowledge needed
- Automated exploitation possible
- Likely already being scanned for by attackers

**Examples**:
- Unauthenticated SQL injection
- Hardcoded admin credentials in source code
- Default credentials not changed
- Public-facing admin panels without auth
- Exposed `.git` directory or config files

**Typical CVSS Score**: 8.0-10.0

---

### üü® Moderate (FIX WITHIN 1 WEEK)
**Criteria**:
- Can be exploited in 1-4 hours
- Requires authentication (but user-level is sufficient)
- Some technical knowledge required
- May require tool customization
- Not commonly scanned but documented in security resources

**Examples**:
- Authenticated IDOR vulnerabilities
- Stored XSS in authenticated areas
- JWT secret exposure requiring token forgery
- SSRF with some restrictions
- API endpoints with weak authorization
- File upload with insufficient validation

**Typical CVSS Score**: 6.0-7.9

---

### üü¶ Complex (FIX WITHIN 1 MONTH)
**Criteria**:
- Requires days to weeks to exploit
- Requires privileged access or specific conditions
- Advanced technical knowledge required
- Multiple steps or precise timing needed
- Custom tools/scripts required
- May require social engineering

**Examples**:
- Race conditions requiring precise timing
- Deserialization with complex gadget chains
- Blind SQL injection requiring extensive testing
- CSRF requiring user interaction
- Privilege escalation requiring multiple steps
- Time-based vulnerabilities

**Typical CVSS Score**: 4.0-5.9

---

### ‚¨ú Theoretical (FIX IN NEXT MAJOR RELEASE)
**Criteria**:
- No known practical exploitation method
- Requires extremely rare conditions
- Purely academic interest
- Very limited impact even if exploited
- Extensive prerequisites that are unlikely

**Examples**:
- Information disclosure with no sensitive info
- Weak password policies (if other controls exist)
- Missing security headers (if application architecture prevents exploitation)
- Low-impact denial of service

**Typical CVSS Score**: 0.1-3.9

## Assessment Steps

### Step 1: Evaluate CVSS Metrics

Use CVSS v3.1 to systematically evaluate:

**Attack Vector (AV)**:
- Network (N): Most exploitable
- Adjacent (A): Requires local network
- Local (L): Requires local access
- Physical (P): Requires physical access

**Attack Complexity (AC)**:
- Low (L): No special conditions
- High (H): Requires specific conditions

**Privileges Required (PR)**:
- None (N): No auth needed
- Low (L): Basic user account
- High (H): Admin account needed

**User Interaction (UI)**:
- None (N): Fully automated
- Required (R): Needs user action

### Step 2: Consider Real-World Factors

Beyond CVSS, consider:

**Exploit Availability**:
- Public exploits exist (more exploitable)
- Exploit framework modules available (Metasploit, etc.)
- Proof-of-concept code published
- Detailed writeups available

**Target Attractiveness**:
- High-value data stored
- Large user base
- Public-facing application
- Industry sector (finance, healthcare = more targeted)

**Detection Difficulty**:
- No logging (harder to detect)
- Minimal monitoring (easier to exploit unnoticed)
- No WAF/IDS (no protection)

**Remediation Difficulty**:
- Easy fix (attacker window closes quickly)
- Complex fix (attacker has longer window)

### Step 3: Assign Exploitability Rating

Combine CVSS metrics with real-world factors:

```python
def calculate_exploitability(vuln):
    # Base CVSS exploitability
    if vuln.cvss >= 9.0 and vuln.attack_vector == "Network" and vuln.auth_required == "None":
        base = "Trivial"
    elif vuln.cvss >= 7.0 and vuln.attack_complexity == "Low":
        base = "Moderate"
    elif vuln.cvss >= 4.0:
        base = "Complex"
    else:
        base = "Theoretical"

    # Adjust for real-world factors
    if vuln.public_exploit_exists:
        base = increase_severity(base)  # Moderate ‚Üí Trivial

    if vuln.requires_rare_conditions:
        base = decrease_severity(base)  # Moderate ‚Üí Complex

    return base
```

### Step 4: Document Assessment

For each vulnerability, document:

```markdown
### [VULN-001] SQL Injection in User Search

**Exploitability**: ‚ö†Ô∏è Trivial

**CVSS v3.1 Vector**: AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
**CVSS Score**: 9.8 (Critical)

**Exploitability Factors**:
- ‚úÖ Network accessible (public endpoint)
- ‚úÖ No authentication required
- ‚úÖ Low attack complexity (simple string manipulation)
- ‚úÖ No user interaction needed
- ‚úÖ Automated exploitation possible

**Real-World Considerations**:
- ‚ö†Ô∏è Public PoC code available for similar vulns
- ‚ö†Ô∏è Automated scanners actively looking for this
- ‚ö†Ô∏è Endpoint not protected by WAF
- ‚ö†Ô∏è No logging on this endpoint
- ‚úÖ High-value target (customer database)

**Time to Exploit**: <10 minutes
**Required Skill Level**: Basic (copy-paste SQL injection payloads)
**Required Tools**: cURL or web browser
**Prerequisites**: None

**Exploitation Scenario**:
```bash
# Step 1: Test for SQL injection (30 seconds)
curl "https://target.com/api/search?q=' OR '1'='1 --"

# Step 2: Extract data (5 minutes)
curl "https://target.com/api/search?q=' UNION SELECT username,password FROM users --"

# Step 3: Profit (attacker has all credentials)
```

**Why Trivial**:
1. Unauthenticated endpoint (no barrier to entry)
2. Classic SQL injection (well-known attack)
3. No WAF or input validation (no defenses)
4. High-value data accessible (worth attacker effort)
5. Likely already being scanned by automated tools

**Recommendation**: **PATCH IMMEDIATELY** - This is likely already being exploited in the wild.
```

## Exploitability Matrix

Create a matrix of all vulnerabilities:

```markdown
| Vuln ID | Type | Severity | Auth Req | Complexity | Time | Exploitability |
|---------|------|----------|----------|------------|------|----------------|
| VULN-001 | SQL Injection | Critical | None | Low | <10m | ‚ö†Ô∏è Trivial |
| VULN-002 | Hardcoded Creds | Critical | None | Low | <5m | ‚ö†Ô∏è Trivial |
| VULN-003 | File Upload | High | User | Low | 15m | üü® Moderate |
| VULN-004 | Path Traversal | High | User | Low | 10m | üü® Moderate |
| VULN-005 | IDOR | High | User | Low | 5m | ‚ö†Ô∏è Trivial |
| VULN-006 | Info Disclosure | Medium | User | Medium | 30m | üü¶ Complex |
| VULN-007 | Weak Crypto | Medium | Admin | High | days | üü¶ Complex |
| VULN-008 | Missing Header | Low | N/A | N/A | N/A | ‚¨ú Theoretical |
```

## Prioritization by Exploitability

```markdown
### Immediate Action Required (‚ö†Ô∏è Trivial)
1. VULN-001: SQL Injection - Patch within 24 hours
2. VULN-002: Hardcoded Credentials - Rotate immediately
3. VULN-005: IDOR - Fix within 48 hours

### Fix This Week (üü® Moderate)
4. VULN-003: File Upload - Restrict file types
5. VULN-004: Path Traversal - Add input validation

### Fix This Month (üü¶ Complex)
6. VULN-006: Info Disclosure - Implement proper error handling
7. VULN-007: Weak Crypto - Upgrade cryptographic algorithms

### Fix in Next Release (‚¨ú Theoretical)
8. VULN-008: Missing Security Header - Add CSP header
```

## Output Format

```markdown
## Exploitability Assessment Summary

### Overview
- **‚ö†Ô∏è Trivial Exploitability**: 3 vulnerabilities - **IMMEDIATE ACTION REQUIRED**
- **üü® Moderate Exploitability**: 2 vulnerabilities - Fix within 1 week
- **üü¶ Complex Exploitability**: 2 vulnerabilities - Fix within 1 month
- **‚¨ú Theoretical**: 1 vulnerability - Fix in next release

### Risk Heat Map

```
                Exploitability ‚Üí
              Trivial | Moderate | Complex | Theoretical
            ---------|----------|---------|-------------
Critical  |    üî•üî•   |    üî•    |         |
High      |    üî•    |    ‚ö†Ô∏è    |    ‚ö†Ô∏è   |
Medium    |          |          |    ‚ÑπÔ∏è    |    ‚ÑπÔ∏è
Low       |          |          |         |    ‚úì
```

üî• = Immediate fix required
‚ö†Ô∏è = Fix this week
‚ÑπÔ∏è = Fix this month
‚úì = Fix when convenient

### Detailed Assessments

*(Include detailed assessment for each vulnerability as shown above)*
```
