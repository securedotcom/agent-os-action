# Create Documentation PR Workflow

This workflow creates a pull request with all generated documentation changes.

## Prerequisites

- Documentation generated
- Git repository initialized
- Write permissions to create branches
- GitHub/GitLab access configured

## Workflow Steps

### 1. Verify Git Status

Check current state:
```bash
git status
git branch
```

Ensure:
- On correct base branch (usually `main`)
- Working directory clean or only doc changes
- Remote configured

### 2. Create Documentation Branch

Generate branch name:
```
{branch_prefix}-{date}-{short_hash}
```

Example: `ai/docs-architect-2024-11-07-abc123`

```bash
git checkout -b ai/docs-architect-2024-11-07-abc123
```

### 3. Stage Documentation Changes

Add all documentation files:
```bash
git add docs/
git add docusaurus.config.js sidebars.js
git add package.json  # If Docusaurus added
git add .gitignore  # If updated
```

### 4. Review Changes

Show what will be committed:
```bash
git diff --cached --stat
git diff --cached docs/
```

Verify:
- Only documentation files
- No secrets exposed
- No unintended changes

### 5. Create Commit

Generate commit message:
```
docs: AI-generated documentation update

- Generated architecture documentation
- Created ADRs for key decisions
- Drafted RFCs for improvements
- Added operational runbooks
- Documented ML models
- Created configuration references

Generated by Agent Doc Creator
```

```bash
git commit -m "docs: AI-generated documentation update

- Generated architecture documentation (X files)
- Created ADRs (Y files)
- Drafted RFCs (Z files)
- Added runbooks
- ML documentation
- Configuration references

AI-generated content marked for review."
```

### 6. Push Branch

```bash
git push origin ai/docs-architect-2024-11-07-abc123
```

### 7. Generate PR Description

Create comprehensive PR description:

```markdown
# ğŸ“š AI-Generated Documentation Update

## Summary

This PR contains automatically generated documentation for the project, including architecture docs, ADRs, RFCs, runbooks, and configuration references.

> âš ï¸ **AI-Generated Content**
> All documentation in this PR was generated by an AI agent. Please review carefully before merging.

## Changes

### Architecture Documentation
- âœ… System overview with architecture diagram
- âœ… Component documentation (5 components)
- âœ… Data flow diagrams
- âœ… Technology stack summary

### Architecture Decision Records (ADRs)
- âœ… ADR-0001: Use PostgreSQL as Primary Database
- âœ… ADR-0002: Use Express.js for API Server
- âœ… ADR-0003: Use JWT for Authentication

### Request for Comments (RFCs)
- ğŸ“ RFC-0001: Migrate to Kubernetes (Draft)
- ğŸ“ RFC-0002: Implement GraphQL API (Draft)

### Operational Runbooks
- âœ… API Service runbook
- âœ… Auth Service runbook
- âœ… On-call procedures
- âœ… Incident response guide

### ML Documentation
- âœ… ML system overview
- âœ… Recommendation model card
- âœ… Dataset documentation

### Configuration References
- âœ… Configuration file index
- âœ… Environment variables reference

## ğŸ“‹ Documentation Validation

**Status**: âœ… PASS (10 warnings)

### Summary
- âœ… All internal links valid (123/123)
- âœ… All code examples valid (67/67)
- âœ… All Mermaid diagrams valid (10/10)
- âš ï¸  5 external link timeouts
- âš ï¸  3 formatting issues
- âš ï¸  2 accessibility issues

<details>
<summary>View Full Validation Report</summary>

[Validation report details here]

</details>

## ğŸ” Review Checklist

Please review the following:

### Critical
- [ ] **Architecture docs** accurately reflect system design
- [ ] **ADRs** correctly identify technical decisions
- [ ] **No secrets exposed** in configuration references
- [ ] **Runbooks** have accurate commands and procedures

### Important
- [ ] **RFC drafts** are reasonable and well-motivated
- [ ] **ML model cards** have accurate metrics
- [ ] **Component docs** describe responsibilities correctly
- [ ] **Diagrams** accurately represent relationships

### Nice to Have
- [ ] Fix external link timeouts
- [ ] Address formatting issues
- [ ] Improve accessibility

## ğŸ¤– AI Generation Details

- **Generated**: 2024-11-07 10:30:00 UTC
- **Agent Version**: 1.0.0
- **Repository Scanned**: main branch @ abc123
- **Files Generated**: 45
- **Files Updated**: 3
- **Human Edits Preserved**: 2 files

## ğŸ“ Human Edits Preserved

The following files had manual edits that were preserved:
- `docs/architecture/api-service.md` - Deployment section
- `docs/adrs/0001-database.md` - Context section

## âš ï¸ Known Issues

1. **RFC-0001** needs validation of Kubernetes migration timeline
2. **Runbook commands** should be tested in staging
3. **ML metrics** need verification with ML team
4. Some **TODO markers** require human input

## ğŸš€ Next Steps

After merging:
1. Review and update RFC drafts
2. Assign owners to RFCs
3. Test runbook procedures
4. Validate ML documentation
5. Fill in TODO sections
6. Set up documentation CI/CD

## ğŸ“š Documentation

- [Agent Doc Creator](https://github.com/yourusername/agent-doc-creator)
- [Documentation Standards](docs/standards/)
- [Contributing Guide](CONTRIBUTING.md)

---

**Generated by Agent Doc Creator** ğŸ¤–
```

### 8. Create Pull Request

**GitHub**:
```bash
gh pr create \
  --title "docs: AI-generated documentation update" \
  --body-file pr-description.md \
  --base main \
  --head ai/docs-architect-2024-11-07-abc123
```

**GitLab**:
```bash
glab mr create \
  --title "docs: AI-generated documentation update" \
  --description "$(cat pr-description.md)" \
  --source-branch ai/docs-architect-2024-11-07-abc123 \
  --target-branch main
```

### 9. Assign Reviewers

If `respect_codeowners: true`:
- Read CODEOWNERS file
- Assign relevant reviewers
- Tag documentation team

### 10. Add Labels

Add appropriate labels:
- `documentation`
- `ai-generated`
- `needs-review`

### 11. Link Related Issues

If applicable, link to:
- Documentation improvement issues
- Feature requests
- Technical debt tickets

### 12. Post Notifications

If configured, notify via:
- **Slack**: Post in #documentation or #engineering
- **Teams**: Post in relevant channel
- **Email**: Notify documentation owners

Example Slack message:
```
ğŸ“š New documentation PR ready for review!

AI-generated docs covering architecture, ADRs, RFCs, and runbooks.

PR: https://github.com/org/repo/pull/123

Please review and provide feedback. All AI-generated content is marked for human validation.
```

## Output

- Git branch created
- Changes committed
- Branch pushed to remote
- Pull request created
- Reviewers assigned
- Labels added
- Notifications sent

## PR Best Practices

1. **Clear title**: Descriptive and concise
2. **Comprehensive description**: List all changes
3. **Validation results**: Include test/validation output
4. **Review checklist**: Guide reviewers
5. **Known issues**: Be transparent about limitations

## Error Handling

- **Git push fails**: Check permissions, resolve conflicts
- **PR creation fails**: Check API access, retry
- **Reviewer assignment fails**: Manually assign
- **Notification fails**: Log error, continue

## Configuration Options

From `config.yml`:

```yaml
create_pr: true
branch_prefix: ai/docs-architect
target_branch: main
respect_codeowners: true
pr_labels:
  - documentation
  - ai-generated
notifications:
  slack_webhook: https://hooks.slack.com/...
  teams_webhook: https://outlook.office.com/...
```

## Next Steps

After PR created:
1. Monitor for review comments
2. Address feedback
3. Update docs as needed
4. Merge when approved
5. Deploy documentation site

